# Kibana Route With Custom Certificates
Starting with the 4.0 release of cluster logging, administrators must create their own route if they
need to utilize custom certificates.  Following are instructions for creating a re-encrypt route for Kibana:

1. Extract the CA cert from the Elasticsearch secret.  This secret is created by the `cluster-logging-operator` to generate certs for the cluster logging components.  It is required to properly create the re-encrypt route
```
oc extract secret/elasticsearch --to=. --keys=admin-ca
```
2. Follow the instructions to create a [re-encrypt route](https://docs.openshift.com/container-platform/3.11/architecture/networking/routes.html#secured-routes) using the contents of the file `admin-ca` from the previous step for the destination ca certificate.

```
apiVersion: "v1"
kind: "Template"
metadata:
  name: kibana-custom-route-template
objects:
- apiVersion: "v1"
  kind: "Route"
  metadata:
    name: kibana-custom
    namespace: openshift-logging
  spec:
    tls:
      key: |
          ${KEY}
      certificate: |
          ${CERT}
      caCertificate: |
          ${CA_CERT}
      destinationCACertificate: |
          ${DEST_CA_CERT}
      termination: reencrypt
      insecureEdgeTerminationPolicy: Redirect
    to:
      kind: Service
      name: ${SERVICE_NAME}
parameters:
  - name: CA_CERT
    displayName: The browser facing The browser facing custom cacert
    required: true
  - name: CERT
    displayName: The browser facing custom cert
    required: true
  - name: KEY
    displayName: The browser facing custom key
    required: true
  - name: DEST_CA_CERT
    displayName: The cacert generated by the cluster-logging-operator
    required: true
  - name: SERVICE_NAME
    displayName: The name of the kibana service
    value: kibana

```
Process and apply the template:
```
oc process -f kibana-route.yaml -p CA_CERT="$(cat cacert)" -p CERT="$(cat cert)" -p KEY="$(cat key)" -p DEST_CA_CERT="$(cat admin-ca)" | oc apply -f -
```

**Note:** The content of `spec.tls.key`, `spec.tls.certificate` and `spec.tls.caCertificate` fields should be the content of your custom key, cert, and ca certificate
